pico-8 cartridge // http://www.pico-8.com
version 29
__lua__

function _init()
	music(0)
	player = {}
	player.x = 5
	player.y = 5
	player.face = 16
	player.points = 0
	player.speed = 2
	player.energy = 100
	banana = {}
	banana.x = 50
	banana.y = 50
	shine = {}
	shine.time = 0
	shine.x = 0
	shine.y = 0
end

function _update()
	if(btn(0)) then 
	player.x=player.x-player.speed 
	player.face = 1
	end

	if(btn(1)) then 
	player.x=player.x+player.speed 
	player.face = 0
	end

	if(btn(2)) then 
	player.y=player.y-player.speed
	player.face = 17
	end

	if(btn(3)) then 
	player.y=player.y+player.speed
	player.face = 16
	end

	if(btn(4) and player.energy > 1) then
	-- player.speed = player.speed + 1
	player.speed = adjSpeed(0.5)
	player.energy = player.energy - 2
	else
	player.speed = 1
	end

	if((mget(player.x /8, player.y/8)) == 3) then 
	-- player.speed = 0.5
	player.speed = adjSpeed(-0.5)
	end

	if(distance(player, banana) < 3) then 
	sfx(1)
	player.points = player.points + 1 
	banana.x = rnd(110)
	banana.y = rnd(110)
		if(player.energy < 70) then
			player.energy = player.energy + 30
			else
			player.energy = 100
		end
	end
end

function _draw()
	-- clear screen
	cls(1)
	-- draw map
	map()
	-- center camera
	camera()
	-- draw player (sprite, x, y)
    spr(player.face,player.x,player.y)
	-- draw banana
    spr(4,banana.x,banana.y)
	rect(0, 119, 101, 126, 8)
	rectfill(1, 120, player.energy, 125, 14)
	print("distance:"..distance(player,banana))
	print("ball is on "..mget(player.x /8, player.y/8))
	str = "Points: "..player.points
	str_len = #str
	print(str, 64-str_len*2, 10, 2)
end

function distance(p0, p1)
 dx=p0.x-p1.x dy=p0.y-p1.y
 return sqrt(dx*dx+dy*dy)
end

-- function isInbounds()

-- end

function adjSpeed(inc)
target_speed = player.speed + inc
	if(inc < 0 and target_speed > 0.5) then
		return target_speed 	
	else if (target_speed < 3) then
		return target_speed
	else return player.speed
	end
	end
end

__gfx__
009999000099990033333333333a3333000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09aaa99009aaa990333333333a3b3ab300000aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9aa999999aa99999333333333b33b333000007a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999999999999333333333bb3b3a30000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9919991991999199333333333b3bbbb3000aaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9999999499999994333333333b3b3b339aaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999940099999403333333333333b330aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00444400004444003333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00999900009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09aaa99009aaa9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9aa999999aa999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999999999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99199199999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
99999994999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999940099999400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00444400004444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020203020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030202020203020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020302020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202030202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202030202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030202020202020202020203020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020302020302020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020203020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202030202020202020302020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202030202020202020302020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020302020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020202020203020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
011000000c053000030000300003120530c05300003000030c053000030000300003120530c05300003000030c053000030000300003120530c05300003000030c053000030000300003120530c0530000300003
000300002f0773106733067340673207733067370673a0672d0002f0002f000210002b0002d0002f0002f000210002b0002d0002f000000070000700007000070000700007000070000700007000070000700007
__music__
02 00424344

